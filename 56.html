<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
    integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
    integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
    crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"
    integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
    crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
    integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="cards.css" />

<script src="cards.js" type="text/javascript"></script>

<script charset="utf-8" lang="Javascript">
    var webSocket;
    var hand;
    var uuid = createUUID();
    var data;
    console.log(uuid);
    document.cookie = "key=" + uuid + ";max-age=2592000;"
    function createUUID() {
        return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
            var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);
            return v.toString(16);
        });
    }
    function refreshHand(data) {
        if (data.hand) {
            $.each(data.hand, function (index, value) {
                //alert(index + ": " + value);
                $("#card" + (index + 1)).attr("src", "cards/" + value + ".svg");
                $("#card" + (index + 1)).attr("name", value);
            });

        }
        if (data.question) {
            $("#bidSection").show();
            //data.AnsNo = data.quNo;
            //data.Answer = $("#bidSign")+ 
            //var answer = "{\"AnsNo\": 3, \"Answer\": \"P\", \"usr\": \"P___bot3\", \"t\": \"Team0\"}";
            //webSocket.send(JSON.stringify(data));

        }

    }
    function passBid() {
        //alert($("#bidSign").val())
        //alert($("#bidValue").val())
        data.AnsNo = data.quNo;
        data.Answer = 'P';
        webSocket.send(JSON.stringify(data));
        $("#bidSection").hide();
    }
    function sendBid() {
        //alert($("#bidSign").val())
        //alert($("#bidValue").val())
        data.AnsNo = data.quNo;
        data.Answer = $("#bidSign").val() + $("#bidValue").val();
        webSocket.send(JSON.stringify(data));
        $("#bidSection").hide();
    }
    function goToTable() {
        $("#seatSelection").hide();
        webSocket = new WebSocket("ws://127.0.0.1:6789/" + document.cookie + "&Room=0");
        webSocket.onmessage = function (message) {
            //console.log("here ");
            console.log(message);
            if (message.data) {
                //console.log(message.data);
                data = JSON.parse(message.data);
                refreshHand(data);

                if (data.event == 'play') {
                    $("#playSection").show();
                }
            }

        }
        var contents;
        for (i = 28; i < 57; i++) {
            if (i == 28) {
                contents += "<option selected value=\"" + i + "\">" + i + "</option>";

            } else {
                contents += "<option value=\"" + i + "\">" + i + "</option>";
            }
        }

        $("#playingTable").show();
        $("#bidValue")[0].innerHTML = contents;
    }
    $(document).ready(function () {

    });

    function selectCard(card) {
        $(".card").removeClass("selectedCard");
        $(card).addClass("selectedCard");
    }
    function play() {
        $("#playedActiveCard").attr("src", $(".selectedCard").attr("src"));
        data.card = $(".selectedCard").attr("name");
        //alert(data.card);
        webSocket.send(JSON.stringify(data));

        $(".selectedCard").remove();
        //$("#playSection").hide();


    }
</script>

<div class="container">

    <div class="container1" id="seatSelection">
        <button type="button" class="btn btn-primary" id="button1" onclick="goToTable()">1</button>
        <button type="button" class="btn btn-primary" onclick="goToTable()">2</button>
        <button type="button" class="btn btn-primary" onclick="goToTable()">3</button>
        <button type="button" class="btn btn-primary" onclick="goToTable()">4</button>
        <button type="button" class="btn btn-primary" onclick="goToTable()">5</button>
        <button type="button" class="btn btn-primary" onclick="goToTable()">6</button>
    </div>



    <div id="playingTable" style="display: none;">
        <div class="row" style="height: 108px;">
            <div class="col-sm">
                <img id='playedCard2' class="card" src='cards/RED_BACK.svg' onclick="">
                2
            </div>
            <div class="col-sm">
                <img id='playedCard1' class="card" src='cards/RED_BACK.svg' onclick="">
                1 </div>
            <div class="col-sm">
                <img id='playedCard6' class="card" src='cards/RED_BACK.svg' onclick="">
                6
            </div>
        </div>
        <div class="row">
            <div class="col-sm">

            </div>
            <div class="col-sm">
                Fold </div>
            <div class="col-sm">

            </div>
        </div>
        <div class="row" style="height: 108px;">
            <div class="col-sm">
                <img id='playedCard3' class="card" src='cards/RED_BACK.svg' onclick="">
                
            </div>
            <div class="col-sm">
                <img id='playedActiveCard' class="card" src='cards/RED_BACK.svg' onclick="">
            </div>
            <div class="col-sm">
                <img id='playedCard5' class="card" src='cards/RED_BACK.svg' onclick="">
                1 </div>
        </div>
        <div class="row">
            <div class="col-sm-2">
                One of three columns

            </div>
            <div class="col-sm-8">
                6
                <div class="btn-group" id="bidSection" style="display: none;">
                    <select class="browser-default custom-select" id="bidSign">
                        <option value="S" selected> Spade</option>
                        <option value="C">Club</option>
                        <option value="D">Diamond</option>
                        <option value="H">Heart</option>

                    </select>

                    <select class="browser-default custom-select" id="bidValue">

                    </select>
                    <div class="btn-group">
                        <button type="button" class="btn btn-primary" id="button1" onclick="sendBid()">Bid</button>
                        <button type="button" class="btn btn-primary" id="button1" onclick="passBid()">Pass</button>
                    </div>
                </div>

                <div class="btn-group" id="playSection" style="display: none;">

                        <button type="button" class="btn btn-primary" id="button1" onclick="play()">Play</button>
                
                </div>

                <div class="hand hhand active-hand">
                    <img id='card1' class="card" src='cards/SA.svg' onclick=selectCard(this)>
                    <img id='card2' class="card" src='cards/SK.svg' onclick=selectCard(this)>
                    <img id='card3' class="card" src='cards/SK.svg' onclick=selectCard(this)>
                    <img id='card4' class="card" src='cards/SK.svg' onclick=selectCard(this)>
                    <img id='card5' class="card" src='cards/SK.svg' onclick=selectCard(this)>
                    <img id='card6' class="card" src='cards/SK.svg' onclick=selectCard(this)>
                    <img id='card7' class="card" src='cards/SK.svg' onclick=selectCard(this)>
                    <img id='card8' class="card" src='cards/SK.svg' onclick=selectCard(this)>
                </div>
            </div>
            <div class="col-sm-2">
                One of three columns
            </div>
        </div>
    </div>

</div>